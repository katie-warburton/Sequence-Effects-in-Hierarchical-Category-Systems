---
title: "Hypothesis 1"
author: "Katie Warburton"
format: html
editor: visual
execute:
    code-fold: true
    code-summary: "Show the code"
---

### Imports

```{r message=FALSE, warning=FALSE, results='hide'}
library(stringr) 
library(tidyverse) 
library(dplyr) 
library(lme4) 
library(ggplot2) 
library(lmtest) 
library(brms) 
library(tidybayes) 
library(parameters) 
library(mclogit) 

set.seed(13)

```

### Data

```{r}
df <- read.csv('Results/level2_trial_data.csv',  na.strings=c("","NA"))  
items <- sprintf("I%02d", 9:23)

df <- df[df$ORDER != 'a',] %>% 
  pivot_longer(cols=all_of(items), names_to = NULL, values_to = 'CAT')
df <- drop_na(df)
```

## Hypothesis 1b

```{r}
df_C <- df[df$LOC == 'C',]
```

Items in the centered location are more likely to be assigned to category:

\(i\) A in the forwards order than in the backwards order

```{r}
df_1bi <- df_C[df_C$ORDER != 'm',]
df_1bi$IS_A <- as.integer(df_1bi$CAT == 'A')
```

```{r}


mbi.1 <- glmer( IS_A ~ 1 + ORDER + (1|STIMULI) + (1|P_ID) ,
              family = binomial,
              data = df_1bi)

mbi.1.1 <- glmer( IS_A ~ 1 + ORDER + POOL + (1|STIMULI) + (1|P_ID) ,
              family = binomial,
              data = df_1bi)

mbi.0 <- glmer(IS_A ~ 1 + (1|STIMULI) + (1|P_ID),
                   data = df_1bi,
                   family = binomial)

summary(mbi.1)
lrtest(mbi.0, mbi.1)
lrtest(mbi.1, mbi.1.1)
```

\(ii\) B in the backwards order than in the forwards order

```{r}
df_bii <- df_C[df_C$ORDER != 'm',]
df_bii$IS_B <- as.integer(df_bii$CAT == 'B')

mbii_1 <- glmer(IS_B ~ 1 + ORDER + (1|STIMULI) + (1|P_ID),
              family = binomial,
              data = df_bii)

mbii_0 <- glmer(IS_B ~ 1 + (1|STIMULI) + (1|P_ID),
                   data = df_bii,
                   family = binomial)

summary(mbii_1)
lrtest(mbii_0, mbii_1)
```

\(iii\) X in the middle order than in the forwards or backwards orders

```{r}
df_biii <- df_C
df_biii$IS_X <- as.integer(df_biii$CAT == 'X')
df_biii$ORDER[df_biii$ORDER != 'm'] <- 'not_m'
df_biii$ORDER <- relevel(factor(df_biii$ORDER), ref = 'not_m')


mbiii_1 <- glmer( IS_X ~ 1 + ORDER  + (1|STIMULI) + (1|P_ID),
              family = binomial,
                control = glmerControl(optimizer = "bobyqa"),
              data = df_biii)

mbiii_0 <- glmer(IS_X ~ 1 + (1|STIMULI) + (1|P_ID),
                   data = df_biii,
                   control = glmerControl(optimizer = "bobyqa"),
                   family = binomial)

summary(mbiii_1)
lrtest(mbiii_0, mbiii_1)
```

## Hypothesis 1c

Items in the left-shifted location are more likely to be assigned to category A in the forwards order than in the backwards order.

```{r}
df_L <- df[df$LOC == 'L',]
df_1c <- df_L[df_L$ORDER != 'm',]
df_1c$IS_A <- as.integer(df_1c$CAT == 'A')

m1c_1 <- glmer(IS_A ~ 1 + ORDER + (1|STIMULI) + (1|POOL) ,
              family = binomial,
              data = df_1c)

m1c_0 <- glmer(IS_A ~ 1 + (1|STIMULI) + (1|POOL),
                   data = df_1c,
                   family = binomial)

summary(m1c_1)
lrtest(m1c_0, m1c_1)

```

## Hypothesis 1d

Items in the right-shifted location are more likely to be assigned to category B in the backwards order than in the forwards order

```{r}
df_R <- df[df$LOC == 'R',]
df_1d <- df_R[df_R$ORDER != 'm',]
df_1d$IS_B <- as.integer(df_1d$CAT == 'B')
df_1d$ORDER <- relevel(factor(df_1d$ORDER), ref='f')

m1d_1 <- glmer(IS_B ~ 1 + ORDER + (1|STIMULI) + (1|POOL) ,
              family = binomial,
              data = df_1d)

m1d_0 <- glmer(IS_B ~ 1 + (1|STIMULI) + (1|POOL),
                   data = df_1d,
                   family = binomial)

summary(m1d_1)
lrtest(m1d_0, m1d_1)
```
