---
title: "Hypothesis 2"
author: "Katie Warburton"
format: html
editor: visual
---

### Imports

```{r message=FALSE, warning=FALSE, results='hide'}
library(stringr) 
library(tidyverse) 
library(dplyr) 
library(lme4) 
library(ggplot2) 
library(lmtest) 
library(brms) 
library(tidybayes) 
library(parameters) 

set.seed(13)
```

### Data

```{r}
df <- read.csv('Results/hyp2_df_long.csv',  na.strings=c("","NA"))  
```

### Hypothesis

Because items are encountered in roughly sequential order (w.r.t. their order in 1D space), items are more likely to be assigned to the same category as the initial item in that sequence (e.g. if a participant assigns the first item to a new category, X, then the likelihood of all subsequent items being assigned to X increases).

### Frequentist

The hypothesis is supported if M1 has an intercept \> 0 and a LRT favours M1 over M0 (p \< .05).Â 

```{r}
m1 <- glmer(SAME ~ 1  + (1|P_ID) + (1|STIMULI),
            family = binomial,
            data = df)

m1.1 <- glmer(SAME ~ 1  + POOL + (1|P_ID) + (1|STIMULI),
            family = binomial,
            data = df)

m1.2 <- glmer(SAME ~ 1 + (1|POOL/P_ID) + (1|STIMULI),
            family = binomial,
            data = df)

lrtest(m1, m1.1)
lrtest(m1, m1.2)
```

```{r}
m0 <- glmer(SAME ~ 0 + (1|P_ID) + (1|STIMULI),
            family = binomial,
            data = df)

lrtest(m0, m1)
fixef(m1)

intercept <- coef(summary(m1))[1]
prob <- exp(intercept) / (1 + exp(intercept))

print(prob)
```

### Exploratory:

Do any factors predict likelihood of being the same?

```{r}
m2 <- glmer(SAME ~ 1  + DEPTH + 
              (1|P_ID) + (1|STIMULI),
            family = binomial,
            data = df)
lrtest(m1, m2)


m3 <- glmer(SAME ~ 1 + FIRST + 
              (1|P_ID) + (1|STIMULI),
            family = binomial,
            data = df)
lrtest(m1, m3)

m4 <- glmer(SAME ~ 1 + LOC + 
              (1|P_ID) + (1|STIMULI),
            family = binomial,
            data = df)

lrtest(m1, m4)


m5 <- glmer(SAME ~ 1 + ORDER + 
              (1|P_ID) + (1|STIMULI),
            family = binomial,
            data = df)

lrtest(m1, m5)
```

Neither depth nor the category of the first item significantly improve the ability of the model to predict same or not same.

```{r}
summary(m5)
```
